#!/usr/bin/awk -f

BEGIN {
    FS = "\t"

    prefix          = ENVIRON["SB_BOOKMARK_PRETTY_PREFIX"]
    fs              = ENVIRON["SB_BOOKMARK_PRETTY_FS"]
    trunc           = ENVIRON["SB_BOOKMARK_PRETTY_TRUNC"]
    date_len        = ENVIRON["SB_BOOKMARK_PRETTY_DATE_LEN"]
    title_len       = ENVIRON["SB_BOOKMARK_PRETTY_TITLE_LEN"]
    title_len_trunc = title_len - length(trunc)
    title_len_fmt   = "%-" title_len "s"
}

{
    print prefix \
          substr($1, 1, date_len) \
          fs \
          (length($3) > title_len ?
           substr($3, 1, title_len_trunc) trunc :
           sprintf(title_len_fmt, $3)) \
          fs \
          $2
}
